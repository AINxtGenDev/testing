First steps with Emscripten (Linux + macOS)
==========================================

Websites
- Emscripten main site: https://emscripten.org/
- Getting started / downloads: https://emscripten.org/docs/getting_started/downloads.html

Prerequisites
1) Linux: install packages for build tools (git, python3, cmake, make, clang).
   - Example (Debian/Ubuntu):
     sudo apt-get update
     sudo apt-get install -y git python3 cmake make clang
2) macOS: install Xcode Command Line Tools (clang, make, git, etc).
   - Run: xcode-select --install

Install Emscripten (Linux or macOS)
1) Get the SDK:
   git clone https://github.com/emscripten-core/emsdk.git
   cd emsdk
2) Install and activate the latest SDK:
   ./emsdk install latest
   ./emsdk activate latest
3) Load the environment in your current shell:
   source ./emsdk_env.sh
4) Verify:
   emcc --version
   em++ --version

Note: Step 3 must be run in each new shell, or add it to your shell profile.

Build your existing C++ file to WebAssembly
1) Example (replace main.cpp with your file):
   em++ main.cpp -O2 -s WASM=1 -o index.html
2) Outputs:
   - index.html
   - index.js
   - index.wasm

Run locally and test in browser
1) Start a simple HTTP server in the output directory:
   python3 -m http.server 8000
2) Open the page locally:
   http://localhost:8000/index.html
3) Open the page from another device on your LAN:
   http://local-ip-address:8000/index.html
   Example:
   http://192.168.1.15:8000/index.html

Tip: find your local IP address
- Linux: ip addr | rg "inet "
- macOS: ifconfig | rg "inet "

After local testing: push to GitHub and use GitHub Actions
1) Check status and commit your changes:
   git status
   git add -A
   git commit -m "Build WASM example"
2) Ensure the branch is main (optional if already on main):
   git branch -M main
3) Add the GitHub remote if needed:
   git remote add origin git@github.com:AINxtGenDev/testing.git
4) Push to GitHub:
   git push -u origin main
   - If you must use the configured SSH key:
     GIT_SSH_COMMAND="ssh -i /home/werner/.ssh/github_werner -o IdentitiesOnly=yes" git push -u origin main

Set up GitHub Actions (CI build on push/PR)
1) Create a workflow file at .github/workflows/ci.yml
2) Example workflow (installs Emscripten and builds):
   name: CI
   on:
     push:
       branches: [main]
     pull_request:
       branches: [main]
   jobs:
     build:
       runs-on: ubuntu-latest
       steps:
         - uses: actions/checkout@v4
         - name: Install Emscripten
           run: |
             git clone https://github.com/emscripten-core/emsdk.git
             cd emsdk
             ./emsdk install latest
             ./emsdk activate latest
             echo "$(pwd)" >> $GITHUB_PATH
         - name: Build
           run: |
             source ./emsdk/emsdk_env.sh
             em++ power_calc.cpp -O2 -s WASM=1 -o index.html
3) Commit and push the workflow:
   git add .github/workflows/ci.yml
   git commit -m "Add GitHub Actions CI build"
   git push
4) Verify the run in GitHub:
   - Open your repo on GitHub
   - Go to the Actions tab and confirm the CI workflow is green

Publish to GitHub Pages (run on https://ainxtgendev.github.io/testing/)
1) Ensure GitHub Pages is enabled:
   - Repo Settings -> Pages -> Source: "GitHub Actions"
2) The deploy workflow builds WASM before publishing:
   - Installs Emscripten
   - Runs ./build_wasm.sh
   - Uploads the site as a Pages artifact
3) Ensure .nojekyll exists in the repo root (needed for .wasm files)
4) Push to main:
   git add .github/workflows/deploy.yml .nojekyll
   git commit -m "Build WASM for Pages deploy"
   git push
5) Verify deployment:
   - GitHub -> Actions -> "Deploy to GitHub Pages" is green
   - Visit https://ainxtgendev.github.io/testing/
